# black, grizzly or teddy bear
this notebook adds an extra dimension to the first notebook by an additional category. i modified the original fastai
notebook to continue to use DuckDuckGo as the Bing search method was more complicated and broken.
  
the initial code and method of data/labels was retained. the `DataBlock` is setup like this:
```python
bears = DataBlock(
    blocks=(ImageBlock, CategoryBlock), 
    get_items=get_image_files, 
    splitter=RandomSplitter(valid_pct=0.2, seed=42),
    get_y=parent_label,
    item_tfms=Resize(128))
```
  
the notebook demonstrates several types of resize methods, then finally uses `RandomResizedCrop` to provide some variation
in the images.
```python
bears = bears.new(
    item_tfms=RandomResizedCrop(224, min_scale=0.5),
    batch_tfms=aug_transforms(mult=2))
dls = bears.dataloaders(path)
```
  
the fine-tuning step remains the same, but we add `ClassificationInterpretation.learner(learn)` to provide a visual
look at errors in classification. this occurred because of the similar shape and color between the different types of 
bears. for example, from a training standpoint with the number of images we use, it might be difficult to distinguish 
between a black and brown bear in some of these images, or there might be a picture of both in a youtube video.
![img.png](class_intp.png)
in the image you can see all the mistakes occurred between black and grizzly bears.
  
we can use an inline command to display some of the losses.
```python
interp.plot_top_losses(5, nrows=1)
```
  
fastai also has an inline data cleaner to correct inappropriate images:
```python
cleaner = ImageClassifierCleaner(learn)
cleaner
```
  
a visual window with dropdowns appear to allow you to re-label, remove and leave an image as is. when you select the
options, you run the below for each label selection. in this case, you run the below for black, grizzly and teddy bears
three times in total:
```python
for idx in cleaner.delete(): cleaner.fns[idx].unlink()
for idx,cat in cleaner.change(): shutil.move(str(cleaner.fns[idx]), path/cat)
```
  
we also export a `.pkl` file to save the model for later:
```python
learn.export()
```
  
then we demonstrate loading and using the file:
```python
learn_inf = load_learner(path/'export.pkl')
learn_inf.predict('grizzly.jpg')
```
